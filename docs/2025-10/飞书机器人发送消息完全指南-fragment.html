<article class="post">
    <header class="post-header">
        <h1 class="post-title">é£ä¹¦æœºå™¨äººå‘é€æ¶ˆæ¯å®Œå…¨æŒ‡å—ï¼šä»curlå‘½ä»¤åˆ°è‡ªåŠ¨åŒ–è„šæœ¬</h1>
        <div class="post-meta">
            <div class="post-date">2025/10/26</div>
            <div class="post-category">2025-10</div>
        </div>
    </header>
    <div class="warning">
        âš ï¸ æ³¨æ„ï¼šæ­¤å†…å®¹ç”± AI ååŠ©ç”Ÿæˆï¼Œå‡†ç¡®æ€§æœªç»éªŒè¯ï¼Œè¯·è°¨æ…ä½¿ç”¨
    </div>
    <div class="post-content" id="post-content">
        <h1
id="é£ä¹¦æœºå™¨äººå‘é€æ¶ˆæ¯å®Œå…¨æŒ‡å—ä»curlå‘½ä»¤åˆ°è‡ªåŠ¨åŒ–è„šæœ¬">é£ä¹¦æœºå™¨äººå‘é€æ¶ˆæ¯å®Œå…¨æŒ‡å—ï¼šä»curlå‘½ä»¤åˆ°è‡ªåŠ¨åŒ–è„šæœ¬</h1>
<h2 id="æ‘˜è¦">æ‘˜è¦</h2>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨é£ä¹¦æœºå™¨äººé€šè¿‡Webhookå‘é€æ¶ˆæ¯ï¼Œæ¶µç›–è‡ªå®šä¹‰æœºå™¨äººåˆ›å»ºã€cURLå‘½ä»¤è°ƒç”¨ã€å¤šç§æ¶ˆæ¯æ ¼å¼å®ç°ä»¥åŠShellè„šæœ¬è‡ªåŠ¨åŒ–å®è·µã€‚é€‚åˆéœ€è¦å®ç°æœåŠ¡å™¨ç›‘æ§ã€è‡ªåŠ¨åŒ–é€šçŸ¥çš„è¿ç»´äººå‘˜å’Œå¼€å‘è€…ã€‚</p>
<h2 id="ç›®å½•">ç›®å½•</h2>
<ol type="1">
<li>#1-é£ä¹¦æœºå™¨äººç±»å‹ä¸é€‰æ‹©</li>
<li>#2-åˆ›å»ºä¸é…ç½®è‡ªå®šä¹‰æœºå™¨äºº</li>
<li>#3-ä½¿ç”¨curlå‘½ä»¤å‘é€æ¶ˆæ¯</li>
<li>#4-æ¶ˆæ¯ç±»å‹ä¸æ ¼å¼è¯¦è§£</li>
<li>#5-å®‰å…¨è®¾ç½®æŒ‡å—</li>
<li>#6-shellè„šæœ¬å®æˆ˜æ¡ˆä¾‹</li>
<li>#7-å¸¸è§é—®é¢˜ä¸è°ƒè¯•</li>
</ol>
<h2 id="é£ä¹¦æœºå™¨äººç±»å‹ä¸é€‰æ‹©">1 é£ä¹¦æœºå™¨äººç±»å‹ä¸é€‰æ‹©</h2>
<p>é£ä¹¦æä¾›ä¸¤ç§ç±»å‹çš„æœºå™¨äººï¼š<strong>åº”ç”¨æœºå™¨äºº</strong>å’Œ<strong>è‡ªå®šä¹‰æœºå™¨äºº</strong>ï¼Œä¸¤è€…åœ¨ä½¿ç”¨åœºæ™¯å’Œèƒ½åŠ›ä¸Šæœ‰æ˜¾è‘—å·®å¼‚ã€‚</p>
<p><strong>åº”ç”¨æœºå™¨äºº</strong>åŠŸèƒ½å…¨é¢ï¼Œéœ€è¦ä¼ä¸šåœ¨é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨å¹¶å¼€å¯æœºå™¨äººèƒ½åŠ›ï¼Œæ”¯æŒå‘é€æ¶ˆæ¯ã€æ¥æ”¶å¹¶å›å¤æ¶ˆæ¯ï¼ˆéœ€è®¢é˜…äº‹ä»¶ï¼‰ã€ç®¡ç†ç¾¤ç»„ä»¥åŠè°ƒç”¨é£ä¹¦ä¸°å¯Œçš„å¼€æ”¾æ¥å£ï¼Œä½†éœ€è¦å‘ç‰ˆå¹¶ç»è¿‡ä¼ä¸šç®¡ç†å‘˜å®¡æ ¸ã€‚å®ƒé€‚åˆæ·±åº¦é›†æˆä¼ä¸šä¸šåŠ¡ç³»ç»Ÿçš„åœºæ™¯ã€‚</p>
<p><strong>è‡ªå®šä¹‰æœºå™¨äºº</strong>é…ç½®ç®€å•ï¼Œé€šè¿‡åœ¨ç¾¤èŠä¸­ç›´æ¥æ·»åŠ â€è‡ªå®šä¹‰æœºå™¨äººâ€ç”Ÿæˆï¼Œä¸»è¦èƒ½åŠ›æ˜¯å‘æ‰€åœ¨ç¾¤ç»„å•å‘æ¨é€æ¶ˆæ¯ï¼Œæ— æ³•äº¤äº’æˆ–è·å–ç¾¤ä¿¡æ¯ï¼Œæ— éœ€å®¡æ ¸å³å¯ä½¿ç”¨ã€‚å®ƒéå¸¸é€‚åˆä¸´æ—¶æˆ–ç®€å•çš„ç¾¤æ¶ˆæ¯æ¨é€éœ€æ±‚ã€‚</p>
<p>å¯¹äºå¤§å¤šæ•°é€šè¿‡è„šæœ¬å‘é€é€šçŸ¥çš„åœºæ™¯ï¼Œ<strong>è‡ªå®šä¹‰æœºå™¨äºº</strong>å› å…¶ç®€å•çš„Webhookè°ƒç”¨æ–¹å¼è€Œæ›´ä¸ºå¸¸ç”¨ã€‚å®ƒæ ¸å¿ƒçš„åŠŸèƒ½å°±æ˜¯ä¸€ä¸ªWebhookåœ°å€ï¼Œå…è®¸ä½ é€šè¿‡å‘è¯¥åœ°å€å‘é€HTTP
POSTè¯·æ±‚æ¥æ¨é€æ¶ˆæ¯åˆ°ç¾¤èŠã€‚</p>
<h2 id="åˆ›å»ºä¸é…ç½®è‡ªå®šä¹‰æœºå™¨äºº">2 åˆ›å»ºä¸é…ç½®è‡ªå®šä¹‰æœºå™¨äºº</h2>
<ol type="1">
<li><strong>è¿›å…¥ç›®æ ‡é£ä¹¦ç¾¤ç»„</strong>ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ç¾¤è®¾ç½®ï¼ˆ<code>...</code>ï¼‰ã€‚</li>
<li>é€‰æ‹©ã€Œç¾¤æœºå™¨äººã€-&gt;ã€Œæ·»åŠ æœºå™¨äººã€-&gt;ã€Œè‡ªå®šä¹‰æœºå™¨äººã€ã€‚</li>
<li>ä¸ºæœºå™¨äººè®¾ç½®åç§°å’Œæè¿°ï¼ˆå¯é€‰ï¼‰ï¼Œç„¶åç‚¹å‡»æ·»åŠ ã€‚</li>
<li>æ·»åŠ æˆåŠŸåï¼Œç³»ç»Ÿä¼šæä¾›ä¸€ä¸ª <strong>Webhook URL</strong>ï¼Œæ ¼å¼é€šå¸¸ä¸º
<code>https://open.feishu.cn/open-apis/bot/v2/hook/xxxxxxxxxxxxxxxxx</code>
ã€‚è¯·å¦¥å–„ä¿å­˜æ­¤URLã€‚</li>
</ol>
<h2 id="ä½¿ç”¨curlå‘½ä»¤å‘é€æ¶ˆæ¯">3 ä½¿ç”¨cURLå‘½ä»¤å‘é€æ¶ˆæ¯</h2>
<p>è·å–Webhook URLåï¼Œå³å¯ä½¿ç”¨ <code>curl</code>
å‘½ä»¤å‘é€æ¶ˆæ¯ã€‚åŸºæœ¬å‘½ä»¤ç»“æ„å¦‚ä¸‹ï¼š</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://open.feishu.cn/open-apis/bot/v2/hook/ä½ çš„Webhookåœ°å€&quot;</span> <span class="dt">\</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;msg_type&quot;: &quot;text&quot;,</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;content&quot;: {</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">          &quot;text&quot;: &quot;è¿™æ˜¯ä¸€æ¡æ¥è‡ªcURLçš„æµ‹è¯•æ¶ˆæ¯&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">      }&#39;</span></span></code></pre></div>
<p>å¦‚æœè¯·æ±‚æˆåŠŸï¼Œä½ ä¼šæ”¶åˆ°ç±»ä¼¼
<code>{"StatusCode":0,"StatusMessage":"success"}</code>
çš„å“åº”ï¼Œå¹¶ä¸”æ¶ˆæ¯ä¼šå‡ºç°åœ¨ç¾¤èŠä¸­ã€‚</p>
<h2 id="æ¶ˆæ¯ç±»å‹ä¸æ ¼å¼è¯¦è§£">4 æ¶ˆæ¯ç±»å‹ä¸æ ¼å¼è¯¦è§£</h2>
<p>é£ä¹¦è‡ªå®šä¹‰æœºå™¨äººæ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ï¼Œä»¥ä¸‹æ˜¯å¸¸è§æ ¼å¼çš„ç¤ºä¾‹ã€‚</p>
<h3 id="æ–‡æœ¬æ¶ˆæ¯-text">4.1 æ–‡æœ¬æ¶ˆæ¯ (text)</h3>
<p>æœ€åŸºæœ¬çš„æ¶ˆæ¯ç±»å‹ï¼Œæ”¯æŒçº¯æ–‡æœ¬ã€‚å¯ä»¥ä½¿ç”¨ <code>&lt;at&gt;</code>
æ ‡ç­¾æ¥@ç¾¤æˆå‘˜æˆ–æ‰€æœ‰äººã€‚</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://open.feishu.cn/open-apis/bot/v2/hook/ä½ çš„Webhookåœ°å€&quot;</span> <span class="dt">\</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;msg_type&quot;: &quot;text&quot;,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;content&quot;: {</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">          &quot;text&quot;: &quot;æœåŠ¡å™¨çŠ¶æ€å‘Šè­¦\næ—¶é—´ï¼š2023-10-26 10:00:00\nå†…å®¹ï¼šCPUä½¿ç”¨ç‡è¶…è¿‡90% &lt;at user_id=\&quot;all\&quot;&gt;æ‰€æœ‰äºº&lt;/at&gt;&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">      }&#39;</span></span></code></pre></div>
<h3 id="å¯Œæ–‡æœ¬æ¶ˆæ¯-post">4.2 å¯Œæ–‡æœ¬æ¶ˆæ¯ (post)</h3>
<p>å¯Œæ–‡æœ¬æ¶ˆæ¯ (<code>post</code>)
æ”¯æŒæ›´å¤æ‚çš„æ’ç‰ˆï¼Œå¯ä»¥åœ¨ä¸€æ¡æ¶ˆæ¯ä¸­ç»„åˆæ–‡æœ¬ã€é“¾æ¥ã€<span class="citation"
data-cites="æåŠç­‰å…ƒç´ ">@æåŠç­‰å…ƒç´ </span>ï¼Œé€šå¸¸ç”¨äºéœ€è¦è‰¯å¥½æ’ç‰ˆçš„é€šçŸ¥ã€‚</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://open.feishu.cn/open-apis/bot/v2/hook/ä½ çš„Webhookåœ°å€&quot;</span> <span class="dt">\</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;msg_type&quot;: &quot;post&quot;,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;content&quot;: {</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">          &quot;post&quot;: {</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;zh_cn&quot;: {</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">              &quot;title&quot;: &quot;æ¯æ—¥æŠ¥è¡¨&quot;,</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">              &quot;content&quot;: [</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">                [</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">                  {&quot;tag&quot;: &quot;text&quot;, &quot;text&quot;: &quot;ä»Šæ—¥æ´»è·ƒç”¨æˆ·: &quot;},</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">                  {&quot;tag&quot;: &quot;text&quot;, &quot;text&quot;: &quot;1,250&quot;, &quot;style&quot;: &quot;bold&quot;}</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">                ],</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">                [</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">                  {&quot;tag&quot;: &quot;text&quot;, &quot;text&quot;: &quot;å…³é”®æŒ‡æ ‡: &quot;},</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">                  {&quot;tag&quot;: &quot;a&quot;, &quot;text&quot;: &quot;æŸ¥çœ‹è¯¦æƒ…&quot;, &quot;href&quot;: &quot;http://example.com/dashboard&quot;}</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="st">                ],</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">                [</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="st">                  {&quot;tag&quot;: &quot;at&quot;, &quot;user_id&quot;: &quot;all&quot;, &quot;user_name&quot;: &quot;æ‰€æœ‰äºº&quot;}</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">                ]</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">              ]</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">          }</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="st">      }&#39;</span></span></code></pre></div>
<h3 id="æ¶ˆæ¯å¡ç‰‡-interactive">4.3 æ¶ˆæ¯å¡ç‰‡ (interactive)</h3>
<p>æ¶ˆæ¯å¡ç‰‡ (<code>interactive</code>)
æ˜¯åŠŸèƒ½æœ€ä¸°å¯Œçš„æ¶ˆæ¯å½¢å¼ï¼Œæ”¯æŒå›¾ç‰‡ã€æŒ‰é’®ã€åˆ†æ ç­‰äº¤äº’å…ƒç´ ï¼ˆå°½ç®¡è‡ªå®šä¹‰æœºå™¨äººçš„æŒ‰é’®é€šå¸¸ä»…æ”¯æŒè·³è½¬é“¾æ¥ï¼‰ã€‚å¯ä»¥ä½¿ç”¨é£ä¹¦æä¾›çš„[æ¶ˆæ¯å¡ç‰‡æ­å»ºå·¥å…·]è¿›è¡Œå¯è§†åŒ–è®¾è®¡ã€‚</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;https://open.feishu.cn/open-apis/bot/v2/hook/ä½ çš„Webhookåœ°å€&quot;</span> <span class="dt">\</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;msg_type&quot;: &quot;interactive&quot;,</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;card&quot;: {</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">          &quot;elements&quot;: [</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">            {</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">              &quot;tag&quot;: &quot;div&quot;,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="st">              &quot;text&quot;: {</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;content&quot;: &quot;**ä»»åŠ¡æ‰§è¡Œç»“æœ**\næ—¶é—´: 2023-10-26 10:00:00\nçŠ¶æ€: &lt;font color=\&quot;green\&quot;&gt;æˆåŠŸ&lt;/font&gt;\nè¯¦æƒ…: æ•°æ®å¤‡ä»½ä»»åŠ¡å·²å®Œæˆã€‚&quot;,</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;tag&quot;: &quot;lark_md&quot;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="st">              }</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="st">            },</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="st">            {</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="st">              &quot;tag&quot;: &quot;action&quot;,</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="st">              &quot;actions&quot;: [</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="st">                {</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="st">                  &quot;tag&quot;: &quot;button&quot;,</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="st">                  &quot;text&quot;: {&quot;tag&quot;: &quot;plain_text&quot;, &quot;content&quot;: &quot;æŸ¥çœ‹æ—¥å¿—&quot;},</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="st">                  &quot;type&quot;: &quot;primary&quot;,</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="st">                  &quot;url&quot;: &quot;http://example.com/logs&quot;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="st">              ]</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="st">          ],</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="st">          &quot;header&quot;: {</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="st">            &quot;title&quot;: {&quot;tag&quot;: &quot;plain_text&quot;, &quot;content&quot;: &quot;ç³»ç»Ÿé€šçŸ¥&quot;}</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="st">          }</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="st">      }&#39;</span></span></code></pre></div>
<h2 id="å®‰å…¨è®¾ç½®æŒ‡å—">5 å®‰å…¨è®¾ç½®æŒ‡å—</h2>
<p>ä¸ºäº†ä¿æŠ¤Webhook
URLï¼Œé˜²æ­¢è¢«æ¶æ„è°ƒç”¨å‘é€åƒåœ¾ä¿¡æ¯ï¼Œé£ä¹¦æä¾›äº†ä¸‰ç§å®‰å…¨è®¾ç½®ï¼Œå»ºè®®è‡³å°‘é…ç½®ä¸€ç§ã€‚</p>
<ul>
<li><strong>è‡ªå®šä¹‰å…³é”®è¯</strong>ï¼šæœ€å¤šè®¾ç½®10ä¸ªå…³é”®è¯ã€‚åªæœ‰æ¶ˆæ¯å†…å®¹ä¸­åŒ…å«è‡³å°‘ä¸€ä¸ªå·²è®¾ç½®çš„å…³é”®è¯æ—¶ï¼Œæ¶ˆæ¯æ‰ä¼šè¢«å‘é€ã€‚ä¾‹å¦‚ï¼Œè®¾ç½®å…³é”®è¯â€ç›‘æ§â€ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä¸­å¿…é¡»åŒ…å«â€ç›‘æ§â€ä¸€è¯ã€‚</li>
<li><strong>IPç™½åå•</strong>ï¼šæœ€å¤šè®¾ç½®10ä¸ªIPåœ°å€æˆ–åœ°å€æ®µã€‚åªæœ‰æ¥è‡ªè¿™äº›IPçš„è¯·æ±‚æ‰ä¼šè¢«å¤„ç†ã€‚</li>
<li><strong>ç­¾åæ ¡éªŒ</strong>ï¼šç³»ç»Ÿæä¾›ä¸€ä¸ªå¯†é’¥ã€‚å‘é€è¯·æ±‚æ—¶ï¼Œéœ€è¦æ ¹æ®æ—¶é—´æˆ³å’Œå¯†é’¥ç”Ÿæˆç­¾åï¼Œå¹¶å°†ç­¾åå’Œæ—¶é—´æˆ³ä¸€åŒæ”¾å…¥è¯·æ±‚ä½“ä¸­ã€‚æœåŠ¡å™¨ä¼šéªŒè¯ç­¾åæ˜¯å¦æœ‰æ•ˆä¸”æ—¶é—´æˆ³ä¸å½“å‰æ—¶é—´ç›¸å·®ä¸è¶…è¿‡1å°æ—¶ã€‚</li>
</ul>
<p>å¯ç”¨ç­¾åæ ¡éªŒåï¼Œè¯·æ±‚ä½“æ ¼å¼å¦‚ä¸‹ï¼š</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;timestamp&quot;</span><span class="ex">:</span> <span class="st">&quot;1599360473&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;sign&quot;</span><span class="ex">:</span> <span class="st">&quot;è®¡ç®—å¾—åˆ°çš„ç­¾å&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;msg_type&quot;</span><span class="ex">:</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;content&quot;</span><span class="ex">:</span> {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;text&quot;</span><span class="ex">:</span> <span class="st">&quot;è¿™æ˜¯ä¸€æ¡å¸¦ç­¾åéªŒè¯çš„æ¶ˆæ¯&quot;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">}</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<p>ç­¾å (<code>sign</code>) çš„ç”Ÿæˆæ–¹æ³•ï¼ˆPythonç¤ºä¾‹ï¼‰å¦‚ä¸‹ï¼š</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hashlib</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> base64</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hmac</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gen_sign(secret):</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    timestamp <span class="op">=</span> <span class="bu">int</span>(time.time())</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    string_to_sign <span class="op">=</span> <span class="ss">f&#39;</span><span class="sc">{</span>timestamp<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>secret<span class="sc">}</span><span class="ss">&#39;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    hmac_code <span class="op">=</span> hmac.new(string_to_sign.encode(<span class="st">&#39;utf-8&#39;</span>), digestmod<span class="op">=</span>hashlib.sha256).digest()</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> base64.b64encode(hmac_code).decode(<span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> timestamp, sign</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ä½¿ç”¨ä»é£ä¹¦æœºå™¨äººå®‰å…¨è®¾ç½®é¡µé¢è·å–çš„SECRET</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>timestamp, sign <span class="op">=</span> gen_sign(<span class="st">&quot;ä½ çš„SECRET&quot;</span>)</span></code></pre></div>
<h2 id="shellè„šæœ¬å®æˆ˜æ¡ˆä¾‹">6 Shellè„šæœ¬å®æˆ˜æ¡ˆä¾‹</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„Shellè„šæœ¬ç¤ºä¾‹ï¼Œç”¨äºå‘é€æœåŠ¡å™¨ç£ç›˜ä½¿ç”¨ç‡å‘Šè­¦ï¼Œå¹¶åŒ…å«å®‰å…¨è®¾ç½®ï¼ˆç­¾åæ ¡éªŒï¼‰å’Œç®€å•çš„é”™è¯¯å¤„ç†ã€‚</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># é£ä¹¦æœºå™¨äººé…ç½®</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="va">FEISHU_WEBHOOK</span><span class="op">=</span><span class="st">&quot;https://open.feishu.cn/open-apis/bot/v2/hook/ä½ çš„Webhookåœ°å€&quot;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="va">SECRET</span><span class="op">=</span><span class="st">&quot;ä½ çš„ç­¾åå¯†é’¥&quot;</span>  <span class="co"># å¦‚æœåœ¨å®‰å…¨è®¾ç½®ä¸­å¯ç”¨äº†ç­¾åæ ¡éªŒåˆ™éœ€è¦</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ç”Ÿæˆç­¾å (å¦‚æœå¯ç”¨äº†ç­¾åæ ¡éªŒ)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">gen_feishu_sign()</span> <span class="kw">{</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">timestamp</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> +%s<span class="va">)</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">string_to_sign</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${timestamp}</span><span class="st">\n</span><span class="va">${SECRET}</span><span class="st">&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">sign</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="at">-en</span> <span class="st">&quot;</span><span class="va">$string_to_sign</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">openssl</span> dgst <span class="at">-sha256</span> <span class="at">-hmac</span> <span class="st">&quot;</span><span class="va">$SECRET</span><span class="st">&quot;</span> <span class="at">-binary</span> <span class="kw">|</span> <span class="fu">base64</span><span class="va">)</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$timestamp</span><span class="st"> </span><span class="va">$sign</span><span class="st">&quot;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># å‘é€é£ä¹¦æ¶ˆæ¯å‡½æ•°</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">send_feishu_alert()</span> <span class="kw">{</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">message</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">message_type</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${2</span><span class="op">:-</span>text<span class="va">}</span><span class="st">&quot;</span>  <span class="co"># é»˜è®¤ä¸ºæ–‡æœ¬æ¶ˆæ¯</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># åˆ¤æ–­æ˜¯å¦éœ€è¦ç”Ÿæˆç­¾å</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">[[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$SECRET</span><span class="st">&quot;</span> <span class="kw">]];</span> <span class="cf">then</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">read</span> <span class="at">-r</span> <span class="va">timestamp</span> <span class="va">sign</span> <span class="op">&lt;&lt;&lt;</span> <span class="st">&quot;</span><span class="va">$(</span><span class="ex">gen_feishu_sign</span><span class="va">)</span><span class="st">&quot;</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">local</span> <span class="va">extra_data</span><span class="op">=</span><span class="st">&quot;</span><span class="dt">\&quot;</span><span class="st">timestamp</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="va">$timestamp</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;</span><span class="st">sign</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="va">$sign</span><span class="dt">\&quot;</span><span class="st">,&quot;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">local</span> <span class="va">extra_data</span><span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># æ„å»ºJSONæ•°æ®</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">json_data</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="va">$message_type</span> <span class="kw">in</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;text&quot;</span><span class="kw">)</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>            <span class="va">json_data</span><span class="op">=</span><span class="st">&quot;{</span><span class="dt">\&quot;</span><span class="st">msg_type</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="st">text</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;</span><span class="st">content</span><span class="dt">\&quot;</span><span class="st">: {</span><span class="dt">\&quot;</span><span class="st">text</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="va">$message</span><span class="dt">\&quot;</span><span class="st">}}&quot;</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">;;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;post&quot;</span><span class="kw">)</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>            <span class="va">json_data</span><span class="op">=</span><span class="st">&quot;{</span><span class="dt">\&quot;</span><span class="st">msg_type</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="st">post</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;</span><span class="st">content</span><span class="dt">\&quot;</span><span class="st">: {</span><span class="dt">\&quot;</span><span class="st">post</span><span class="dt">\&quot;</span><span class="st">: {</span><span class="dt">\&quot;</span><span class="st">zh_cn</span><span class="dt">\&quot;</span><span class="st">: {</span><span class="dt">\&quot;</span><span class="st">title</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="st">ç³»ç»Ÿå‘Šè­¦</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;</span><span class="st">content</span><span class="dt">\&quot;</span><span class="st">: [[{</span><span class="dt">\&quot;</span><span class="st">tag</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="st">text</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;</span><span class="st">text</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="va">$message</span><span class="dt">\&quot;</span><span class="st">}]]}}}}&quot;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">;;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>        <span class="pp">*</span><span class="kw">)</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>            <span class="va">json_data</span><span class="op">=</span><span class="st">&quot;{</span><span class="dt">\&quot;</span><span class="st">msg_type</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="st">text</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;</span><span class="st">content</span><span class="dt">\&quot;</span><span class="st">: {</span><span class="dt">\&quot;</span><span class="st">text</span><span class="dt">\&quot;</span><span class="st">: </span><span class="dt">\&quot;</span><span class="va">$message</span><span class="dt">\&quot;</span><span class="st">}}&quot;</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">;;</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">esac</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># å¦‚æœæœ‰ç­¾åä¿¡æ¯ï¼Œæ’å…¥åˆ°JSONä¸­</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">[[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$extra_data</span><span class="st">&quot;</span> <span class="kw">]];</span> <span class="cf">then</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">json_data</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$json_data</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/{</span><span class="dt">\&quot;</span><span class="st">/{</span><span class="dt">\&quot;</span><span class="va">$extra_data</span><span class="dt">\&quot;</span><span class="st">/&quot;</span><span class="va">)</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># å‘é€è¯·æ±‚</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="va">response</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-w</span> <span class="st">&quot;%{http_code}&quot;</span> <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;</span><span class="va">$FEISHU_WEBHOOK</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">-d</span> <span class="st">&quot;</span><span class="va">$json_data</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    <span class="va">http_code</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$response</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n1</span><span class="va">)</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="va">body</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$response</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> <span class="at">-1</span><span class="va">)</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$http_code</span><span class="st">&quot;</span> <span class="ot">-eq</span> 200 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;æ¶ˆæ¯å‘é€æˆåŠŸ&quot;</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;æ¶ˆæ¯å‘é€å¤±è´¥, HTTPä»£ç : </span><span class="va">$http_code</span><span class="st">, å“åº”: </span><span class="va">$body</span><span class="st">&quot;</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="co"># æ£€æŸ¥ç£ç›˜ä½¿ç”¨ç‡å¹¶å‘é€å‘Šè­¦</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="fu">check_disk_usage()</span> <span class="kw">{</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">threshold</span><span class="op">=</span>90  <span class="co"># è®¾ç½®é˜ˆå€¼ç™¾åˆ†æ¯”</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    <span class="bu">local</span> <span class="va">usage</span><span class="op">=</span><span class="va">$(</span><span class="fu">df</span> / <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;NR==2 {print $5}&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/%//&#39;</span><span class="va">)</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$usage</span><span class="st">&quot;</span> <span class="ot">-gt</span> <span class="st">&quot;</span><span class="va">$threshold</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>        <span class="bu">local</span> <span class="va">hostname</span><span class="op">=</span><span class="va">$(</span><span class="fu">hostname</span><span class="va">)</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>        <span class="bu">local</span> <span class="va">current_time</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="st">&quot;+%Y-%m-%d %H:%M:%S&quot;</span><span class="va">)</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>        <span class="bu">local</span> <span class="va">message</span><span class="op">=</span><span class="st">&quot;ğŸš¨ ç£ç›˜ç©ºé—´å‘Šè­¦ ğŸš¨</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="st">æœåŠ¡å™¨: </span><span class="va">$hostname</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a><span class="st">æ—¶é—´: </span><span class="va">$current_time</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a><span class="st">æ ¹åˆ†åŒºä½¿ç”¨ç‡: </span><span class="va">${usage}</span><span class="st">%</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a><span class="st">çŠ¶æ€: âš ï¸ è¶…è¿‡é˜ˆå€¼ </span><span class="va">${threshold}</span><span class="st">%</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a><span class="st">å»ºè®®: è¯·åŠæ—¶æ¸…ç†ç£ç›˜ç©ºé—´ &lt;at user_id=</span><span class="dt">\&quot;</span><span class="st">all</span><span class="dt">\&quot;</span><span class="st">&gt;æ‰€æœ‰äºº&lt;/at&gt;&quot;</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;æ£€æµ‹åˆ°ç£ç›˜ä½¿ç”¨ç‡è¿‡é«˜ï¼Œå‘é€å‘Šè­¦...&quot;</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>        <span class="ex">send_feishu_alert</span> <span class="st">&quot;</span><span class="va">$message</span><span class="st">&quot;</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;ç£ç›˜ä½¿ç”¨ç‡æ­£å¸¸: </span><span class="va">${usage}</span><span class="st">%&quot;</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a><span class="co"># ä¸»ç¨‹åº</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a><span class="fu">main()</span> <span class="kw">{</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;å¼€å§‹æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...&quot;</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>    <span class="ex">check_disk_usage</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># å¯ä»¥æ·»åŠ å…¶ä»–æ£€æŸ¥å‡½æ•°ï¼Œå¦‚å†…å­˜ã€CPUç­‰</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a><span class="co"># æ‰§è¡Œä¸»ç¨‹åº</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a><span class="ex">main</span></span></code></pre></div>
<h2 id="å¸¸è§é—®é¢˜ä¸è°ƒè¯•">7 å¸¸è§é—®é¢˜ä¸è°ƒè¯•</h2>
<ol type="1">
<li><strong>è¿”å›é”™è¯¯ç  19024 (Key Words Not Found)</strong>
<ul>
<li><strong>åŸå› </strong>ï¼šæœºå™¨äººçš„å®‰å…¨è®¾ç½®ä¸­å¯ç”¨äº†â€è‡ªå®šä¹‰å…³é”®è¯â€ï¼Œä½†å‘é€çš„æ¶ˆæ¯ä¸­ä¸åŒ…å«ä»»ä½•å·²è®¾ç½®çš„å…³é”®è¯ã€‚</li>
<li><strong>è§£å†³</strong>ï¼šåœ¨æ¶ˆæ¯å†…å®¹ä¸­åŠ å…¥ä½ è®¾ç½®çš„å…³é”®è¯ï¼Œæˆ–è€…ä¿®æ”¹/å…³é—­è‡ªå®šä¹‰å…³é”®è¯è®¾ç½®ã€‚</li>
</ul></li>
<li><strong>è¿”å›é”™è¯¯ç  19022 (Ip Not Allowed)</strong>
<ul>
<li><strong>åŸå› </strong>ï¼šå¯ç”¨äº†IPç™½åå•ï¼Œä½†å‘é€è¯·æ±‚çš„æœåŠ¡å™¨IPä¸åœ¨ç™½åå•ä¸­ã€‚</li>
<li><strong>è§£å†³</strong>ï¼šå°†å‘é€è¯·æ±‚çš„æœåŠ¡å™¨IPæ·»åŠ åˆ°æœºå™¨äººçš„IPç™½åå•ä¸­ã€‚</li>
</ul></li>
<li><strong>è¿”å›é”™è¯¯ç  19021 (sign match failâ€¦)</strong>
<ul>
<li><strong>åŸå› </strong>ï¼šç­¾åæ ¡éªŒå¤±è´¥ã€‚å¯èƒ½å› ä¸ºæ—¶é—´æˆ³è¿‡æœŸï¼ˆä¸å½“å‰æ—¶é—´ç›¸å·®è¶…è¿‡1å°æ—¶ï¼‰ã€æœåŠ¡å™¨æ—¶é—´ä¸å‡†ç¡®ï¼Œæˆ–ç­¾åè®¡ç®—é”™è¯¯ã€‚</li>
<li><strong>è§£å†³</strong>ï¼šæ£€æŸ¥æœåŠ¡å™¨æ—¶é—´æ˜¯å¦å‡†ç¡®ï¼Œå¹¶ç¡®è®¤ç­¾åç®—æ³•æ˜¯å¦æ­£ç¡®ã€‚</li>
</ul></li>
<li><strong>æ¶ˆæ¯æ ¼å¼é”™è¯¯æˆ–æ˜¾ç¤ºå¼‚å¸¸</strong>
<ul>
<li><strong>åŸå› </strong>ï¼šJSONæ ¼å¼ä¸æ­£ç¡®ï¼Œæˆ–ç‰¹å®šçš„æ¶ˆæ¯ç±»å‹ç»“æ„æœ‰è¯¯ã€‚</li>
<li><strong>è§£å†³</strong>ï¼šä½¿ç”¨åœ¨çº¿JSONéªŒè¯å·¥å…·æ£€æŸ¥JSONæ ¼å¼ã€‚ä»”ç»†é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œç¡®ä¿æ¶ˆæ¯ä½“ç»“æ„ç¬¦åˆå¯¹åº”æ¶ˆæ¯ç±»å‹çš„è¦æ±‚ã€‚</li>
</ul></li>
<li><strong><span class="citation"
data-cites="æŸäººæˆ–">@æŸäººæˆ–</span><span class="citation"
data-cites="æ‰€æœ‰äººä¸ç”Ÿæ•ˆ">@æ‰€æœ‰äººä¸ç”Ÿæ•ˆ</span></strong>
<ul>
<li><strong>åŸå› </strong>ï¼šè¯­æ³•é”™è¯¯æˆ–IDä¸æ­£ç¡®ã€‚<code>@</code>æŒ‡å®šæˆå‘˜æ—¶ï¼Œ<code>user_id</code>
å¿…é¡»ä½¿ç”¨æ­£ç¡®çš„ <code>ou_xxxxx</code> æ ¼å¼çš„
open_idã€‚<code>@</code>æ‰€æœ‰äººéœ€è¦ç¾¤ç»„å¼€å¯äº†<code>@æ‰€æœ‰äºº</code>åŠŸèƒ½ã€‚</li>
</ul></li>
</ol>
<p>é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†ä½¿ç”¨é£ä¹¦è‡ªå®šä¹‰æœºå™¨äººé€šè¿‡cURLå’ŒShellè„šæœ¬å‘é€æ¶ˆæ¯çš„åŸºæœ¬æ–¹æ³•ã€‚å…³é”®åœ¨äºè·å–æ­£ç¡®çš„Webhook
URLï¼Œæ„é€ åˆæ³•çš„JSONæ¶ˆæ¯ä½“ï¼Œå¹¶æ ¹æ®éœ€è¦é…ç½®å¥½å®‰å…¨è®¾ç½®ã€‚</p>

    </div>
</article>

<script>
    // Add copy buttons to code blocks
    function addCopyButtons() {
        const sourceCodeBlocks = document.querySelectorAll('.sourceCode');
        sourceCodeBlocks.forEach(function(block) {
            if (block.querySelector('.copy-button')) return;
            const preElement = block.querySelector('pre');
            if (!preElement) return;

            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'å¤åˆ¶';
            button.setAttribute('aria-label', 'å¤åˆ¶ä»£ç ');

            button.addEventListener('click', function() {
                const code = preElement.querySelector('code');
                const text = code ? code.innerText : preElement.innerText;

                navigator.clipboard.writeText(text).then(function() {
                    button.textContent = 'å·²å¤åˆ¶';
                    button.classList.add('copied');

                    setTimeout(function() {
                        button.textContent = 'å¤åˆ¶';
                        button.classList.remove('copied');
                    }, 3000);
                }).catch(function(err) {
                    console.error('å¤åˆ¶å¤±è´¥: ', err);
                    button.textContent = 'å¤±è´¥';
                    setTimeout(function() {
                        button.textContent = 'å¤åˆ¶';
                    }, 3000);
                });
            });

            block.appendChild(button);
        });

        const allPreBlocks = document.querySelectorAll('pre:not(.mermaid)');
        allPreBlocks.forEach(function(block) {
            if (block.closest('.sourceCode') || block.querySelector('.copy-button')) return;

            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'å¤åˆ¶';
            button.setAttribute('aria-label', 'å¤åˆ¶ä»£ç ');

            button.addEventListener('click', function() {
                const code = block.querySelector('code');
                const text = code ? code.innerText : block.innerText;

                navigator.clipboard.writeText(text).then(function() {
                    button.textContent = 'å·²å¤åˆ¶';
                    button.classList.add('copied');

                    setTimeout(function() {
                        button.textContent = 'å¤åˆ¶';
                        button.classList.remove('copied');
                    }, 3000);
                }).catch(function(err) {
                    console.error('å¤åˆ¶å¤±è´¥: ', err);
                    button.textContent = 'å¤±è´¥';
                    setTimeout(function() {
                        button.textContent = 'å¤åˆ¶';
                    }, 3000);
                });
            });

            block.appendChild(button);
        });
    }

    // Initialize copy buttons after content loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            addCopyButtons();
        });
    } else {
        addCopyButtons();
    }
</script>
