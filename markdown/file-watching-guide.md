# 自动化 Markdown 转 HTML 转换指南

本文档介绍了如何使用文件监视功能自动将 Markdown 文件转换为 HTML。

## 功能概述

本项目提供了两种文件监视方式：

1. **Chokidar 方案** - 使用 Node.js 的 chokidar 库实现的自定义监视脚本
2. **Nodemon 方案** - 使用 nodemon 工具实现的监视方案

两种方案都支持增量构建，即只转换被修改的文件，而不是重新转换所有文件。

## 使用 Chokidar 监视文件

### 启动监视器

```bash
npm run watch-chokidar
```

### 功能特点

- 实时监视 `markdown/` 目录中的所有文件变化
- 支持文件添加、修改和删除事件
- 支持目录创建和删除事件
- 自动创建所需的目录结构
- 只转换发生变化的文件（增量构建）
- 使用 Pandoc 进行 Markdown 到 HTML 的转换

## 使用 Nodemon 监视文件

### 启动监视器

```bash
npm run watch-nodemon
```

### 功能特点

- 使用 nodemon 工具监视文件变化
- 只监视 `.md` 文件的修改
- 文件修改时调用 `convert-single-md.js` 脚本进行转换
- 支持增量构建

## 增量构建原理

两种方案都实现了增量构建，即只处理发生变化的文件，而不是重新处理所有文件。这样可以大大提高转换效率，特别是在文档数量较多时。

### 工作流程

1. 监视 `markdown/` 目录中的文件变化
2. 当检测到文件修改时：
   - 确定修改的文件路径
   - 提取文件的元数据（标题、日期等）
   - 使用 Pandoc 将单个 Markdown 文件转换为 HTML
   - 将生成的 HTML 文件保存到对应的 `docs/` 目录中

### 性能优势

- 避免了重复处理未修改的文件
- 减少了构建时间
- 提高了开发体验

## 自定义转换脚本

### convert-single-md.js

这个脚本用于单个文件的转换，被 nodemon 方案使用。

使用方法：
```bash
node src/convert-single-md.js path/to/file.md
```

### watch-md-chokidar.js

这个脚本实现了完整的文件监视功能，被 `watch-chokidar` 命令使用。

## 注意事项

1. 确保已安装 Pandoc，因为转换过程依赖于 Pandoc
2. 监视器会忽略隐藏文件（以 `.` 开头的文件）
3. 为安全起见，目录删除操作不会自动删除对应的输出目录
4. 可以通过 Ctrl+C 停止监视器

## 故障排除

如果遇到问题，请检查：

1. 是否正确安装了所有依赖项
2. Pandoc 是否已正确安装并可在命令行中使用
3. 文件权限是否正确
4. 控制台输出的错误信息